<div class="container my-5">
  <h1 class="text-center mb-5 fw-bold text-primary">OCR Platform Dashboard</h1>

  <div class="card shadow-lg border-0 mb-5">
    <div class="card-body p-5">
      <h3 class="card-title text-center mb-4">Upload Images for OCR</h3>

      <div class="mb-4">
        <input 
          type="file" 
          class="form-control form-control-lg" 
          (change)="onFileSelected($event)" 
          multiple 
          accept="image/*"
          [disabled]="loading">
        <small class="form-text text-muted d-block text-center mt-2">
          Select one or more images (JPG, PNG, etc.)
        </small>
      </div>

      <div class="text-center">
        <button 
          type="button"
          class="btn btn-primary btn-lg px-5" 
          (click)="upload()" 
          [disabled]="loading || !selectedFiles?.length">
          <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status"></span>
          {{ loading ? 'Processing...' : 'Extract Text' }}
        </button>
      </div>

      <div class="alert alert-warning text-center mt-4" *ngIf="loading">
        <strong>Processing in progress...</strong><br>
        This may take 10â€“60 seconds. <strong>Please do not refresh!</strong>
      </div>

      <div class="alert alert-success text-center mt-4" *ngIf="message && !loading && !error">
        <strong>Success!</strong> {{ message }}
      </div>

      <div class="alert alert-danger text-center mt-4" *ngIf="error">
        <strong>Error:</strong> {{ error }}
      </div>
    </div>
  </div>

  <div *ngIf="results.length > 0" class="mt-5">
    <h2 class="text-center mb-5 fw-bold">Extraction Results</h2>

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
      <div class="col" *ngFor="let result of results">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body d-flex flex-column">
            
            <h5 class="card-title text-center text-truncate mb-3">
              {{ result.originalFilename }}
            </h5>

            <div class="bg-light p-3 rounded flex-grow-1 mb-3" style="max-height: 200px; overflow-y: auto;">
              <p class="text-muted small mb-2"><strong>Extracted Text:</strong></p>
              <p class="card-text">
                {{ result.preview || 'No text extracted' }}
              </p>
            </div>

            <div class="mt-auto" *ngIf="result.status !== 'error'">
              <div class="btn-group w-100" role="group">
                <button class="btn btn-sm btn-outline-secondary" (click)="download(result.fileId, 'text')">TXT</button>
                <button class="btn btn-sm btn-outline-info" (click)="download(result.fileId, 'pdf')">PDF</button>
                <button class="btn btn-sm btn-outline-success" (click)="download(result.fileId, 'docx')">DOCX</button>
              </div>
            </div>

            <div class="alert alert-danger small mt-3 p-2" *ngIf="result.status === 'error' || result.error">
              {{ result.error || 'Failed to process this file' }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="text-center py-5" *ngIf="!loading && results.length === 0 && !message && !error">
    <div class="display-1 text-muted mb-4">ðŸ“„</div>
    <h3 class="text-muted">No uploads yet</h3>
    <p class="text-muted">Select images above to start!</p>
  </div>
</div>